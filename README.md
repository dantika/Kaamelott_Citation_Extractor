# Kaamelott Citation Extractor

> ğŸ› ï¸ An XML parser to extract and structure quotes from the Kaamelott Wikiquote pages.

---

## ğŸš€ Features

* Extract quotes ("citations") from XML dump of [Wikiquote - Kaamelott](https://fr.wikiquote.org/wiki/Kaamelott)
* Support for multiple quote formats
* Regex-based content extraction
* Handles both global and specific character citations
* Generates structured output in JSON format

---

## ğŸ‘¨â€ğŸ’» Todo

* Adding tests
* Parsing Dialogs page
* Parsing Comics page

---

## ğŸ“ Project Structure

```bash
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ constants/
â”‚   â”‚   â”œâ”€â”€ cleaning-regexp.constant.ts       # Regex for cleaning
â”‚   â”‚   â”œâ”€â”€ citations-extract.constant.ts     # Regex for extraction
â”‚   â”‚   â”œâ”€â”€ episodes-names.constant.ts        # Matrix of matching of all episodes names
â”‚   â”‚   â”œâ”€â”€ filenames.constant.ts             # Filenames used
â”‚   â”‚   â”œâ”€â”€ xml-urls.constant.ts              # XML dump URLs
â”‚   â”‚   â”œâ”€â”€ file-extension.enum.ts            # File extensions used
â”‚   â”‚   â”œâ”€â”€ media.enum.ts                     # MEDIA_TYPE enum
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”œâ”€â”€ citation.model.ts                 # Citation builder/model
â”‚   â”‚   â””â”€â”€ episode.model.ts                  # Episode structure
â”‚   â”‚   â””â”€â”€ log-level.model.ts                # Levels of logger
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ common.service.ts
â”‚   â”‚   â”œâ”€â”€ fetching.service.ts               # For fetching XML data
â”‚   â”‚   â”œâ”€â”€ file.service.ts                   # For file writing
â”‚   â”‚   â”œâ”€â”€ logger.service.ts                 # For logging infos, warnings and errors
â”‚   â”‚   â””â”€â”€ parser.service.ts                 # Quote parsing logic
â”‚   â”œâ”€â”€ tools/
â”‚   â”‚   â”œâ”€â”€ citations.json                    # File generated by the parser to test data validity
â”‚   â”‚   â”œâ”€â”€ variation-extractor.js            # Script to extract each value of the results JSON file into a .txt
â”‚   â”‚   â””â”€â”€ variations.txt                    # File that regroup all variations of datas without any double
â”‚   â”œâ”€â”€ citations.parser.ts                   # Core parsing orchestration
â”‚   â””â”€â”€ index.ts                              # Entry point
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â”œâ”€â”€ README.md
â”œâ”€â”€ LICENSE.txt
â””â”€â”€ .gitignore
```

---

## ğŸ“¦ Installation

```bash
git clone https://github.com/yourusername/kaamelott-citation-extractor.git
cd kaamelott-citation-extractor
npm install
```

---

## ğŸ› ï¸ Usage

You can directly run start. No need to build manually, it will be broken because need to copy some folders.

### 1. Run the extractor

```bash
npm start
```

This will:

* Compile TypeScript into `dist/`
* Run `dist/index.js`
* Parse and extract quotes
* Output structured data into a JSON file (e.g. `citations.json` and orthers one when implemented)

---

## ğŸ“‘ Output Format

Each quote is saved as a structured object:

```ts
{
  character_name: string;
  author: string;
  actor: string;
  description: string;
  media: string; // "SÃ©rie" or "Film"
  season: string;
  episode: { name: string; number: string | number; };
  title: string;
  show: string;
  date: string;
}
```

---

## ğŸ§ª Development

Use `src/citations.parser.ts` to tweak how citations are detected, cleaned, and structured. Regex rules are defined in:

* `citations-extract.constants.ts`
* `cleaning-regexp.constants.ts`

---

## ğŸ§© Dependencies

* [TypeScript](https://www.typescriptlang.org/)
* [cpx](https://www.npmjs.com/package/cpx) â€“ Copy files after build

---

## ğŸ“„ License

This project is released under a **custom non-commercial license**.

You are **free to use, modify and distribute** this code **for personal or non-commercial use only**.

### ğŸš« Commercial Use Restriction

Commercial use (including in proprietary software, SaaS products, paid platforms or integrations) is **not permitted** without **prior written consent** from the author.

If you are interested in using this project in a commercial context, please contact:

ğŸ“§ **Benjamin Bats** â€“ [bats.benjamin@gmail.com](mailto:bats.benjamin@gmail.com)

All rights reserved unless explicitly granted in writing.

---

## ğŸ§™â€â™‚ï¸ Author

Benjamin Bats
